<html lang="en">
  <head>
      <link rel="shortcut icon" id="dynamic-favicon" href="../favicon.ico"/>
    <title id="dynamic-title">Night</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!--- Style --->
    <style>
      body {
        margin: 0;
      }

      iframe {
        display: block;
        background: #000;
        border: none;
        height: 100vh;
        width: 100vw;
      }
      .home {
        border-radius: 30%;
	margin-left: 1px;
	margin-right: 1px;
        width:50px;
        height:50px;
        background-color: #212121;
        border:none;
      }
      .reload {
        border-radius: 30%;
	margin-left: 1px;
	margin-right: 1px;
        width:50px;
        height:50px;
        background-color: #212121;
        border:none;
      }
      .back {
        border-radius: 30%;
	margin-left: 1px;
	margin-right: 1px;
        width:50px;
        height:50px;
        background-color: #212121;
        border:none;
      }

      .forward {
        border-radius: 30%;
	margin-left: 1px;
	margin-right: 1px;
        width:50px;
        height:50px;
        background-color: #212121;
        border:none;
      }

      .bookmarkbtn {
        border-radius: 30%;
	margin-left: 1px;
	margin-right: 1px;
        width:50px;
        height:50px;
        background-color: #212121;
        border:none;
      }
      
      i {
        color: white;
      }
	form {
	margin-left: 1px;
	margin-right: 1px;
	top: 10px;
    	position: relative;
	}
	    
      .form__input {
        border: none;
        border-radius: 30px;
        font-size: 16px;
        width: 100px;
        box-shadow: 0 0 5px rgba(196, 196, 196, 0.3);
        background-color: #212121;
        text-align: center;
        color: #808080;
        cursor:cell;
      }
      
        .input {
	padding: 20px;
	width: 550px;
        border-radius: 30px;
        background:  #212121;
	text-align: center;
	border: none;
	outline: none;
	color: white;
        }

      .menubtn {
        border-radius: 30%;
	margin-left: 1px;
	margin-right: 1px;
        width:50px;
        height:50px;
        background-color: #212121;
        border:none;
      }

      .sidebar {
  height: 70%;
  width: 15%;
  border-radius:30px;
  position: fixed;
  z-index: 1;
  top: 0;
  right: 0;
  background-color: #212121;
  overflow-x: hidden;
  transition: 0.5s;
  padding-top: 5px;
  padding-right: 5px;
  visibility: hidden;
}

.sidebar a, .dropdown-btn {
  text-decoration: none;
  text-align:center;
  font-size: 16px;
  border: none;
  background: none;
  color: #818181;
  display: block;
  transition: 0.3s;
}
.dropdown-btn {
  margin-left: 15px;
}

.sidebar a:hover .dropdown-btn:hover {
  color: #f1f1f1;
}

#main {
  transition: margin-left .5s;
  padding: 16px;
}

.dropdown-container {
  display: none;
  background-color: #262626;
  padding-left: 8px;
}

/* Optional: Style the caret down icon */
.fa-caret-down {
  float: right;
  padding-right: 8px;
}

    </style>
  </head>
  <body>
    <script src="uv/uv.bundle.js"></script>
    <script src="uv/uv.config.js"></script>
    <iframe src="" id="iframeId" style="bottom: 0" style="border: 0px #ffffff none" name="Iframe" scrolling="yes" frameborder="0" marginheight="0px" marginwidth="0px" height="100%" width="100%" allowfullscreen></iframe>
    <div style="position:absolute;left:0;top:10px;height:50px;" id="browser">
    <div style="display:flex;align-items:center;height:50px;">
    <button id="home-page" class="home" onclick="window.location.href = './';"> <i class="fa-solid fa-house"></i> </button>
    <form id="uv-form">
    <input id="uv-search-engine" class="input" value="https://www.google.com/search?q=%s" type="hidden"/> 
    <input id="uv-address" type="text" class="input" placeholder="Search Google or type an URL" class="form__input"/>
    </form>
    <button onclick="reload()" class="reload"> <i class="fa-solid fa-rotate-right"></i> </button>
    <button onclick="back()" class="back"> <i class="fa-solid fa-backward"></i> </button>
    <button onclick="forward()" class="forward"> <i class="fa-solid fa-forward"></i> </button>
    <button class="bookmarkbtn" id="bookmarkbtn"> <i class="fa-solid fa-star"></i> </button>
    </div>
    </div>
    <div style="position:fixed;top:10px;right:10px;">
      <button onclick="togglemenu();" class="menubtn"><i class="fa-solid fa-bars"></i></button>
    </div>
    <div id="mySidebar" class="sidebar">
      <a style="text-align:right;font-size:13px;top:5px;right:5px;" onclick="togglemenu();"><i class="fa-solid fa-x"></i></a>
      <br>
      <a style="text-align:center;font-size:16px;" onclick="hide();">Toggle Topbar</a>
      <button class="dropdown-btn">Bookmarks 
        <i class="fa fa-caret-down"></i>
      </button>
      <div class="dropdown-container">
        <a onclick="localStorage.removeItem('titleUrlList')">Clear Bookmarks</a>
      </div>
      <a style="text-align:center;font-size:16px;"href="#">Clients</a>
      <a style="text-align:center;font-size:16px;"href="#">Inspect</a>
    </div>

    <script>
      document.head = document.head || document.getElementsByTagName('head')[0];

function changeFavicon(src) {
 var link = document.createElement('link'),
     oldLink = document.getElementById('dynamic-favicon');
 link.id = 'dynamic-favicon';
 link.rel = 'shortcut icon';
 link.href = src;
 if (oldLink) {
  document.head.removeChild(oldLink);
 }
 document.head.appendChild(link);
};
      function reload() {
        document.getElementById("iframeId").src = document.getElementById("iframeId").src;
      }
     function back() {
       document.getElementById("iframeId").contentWindow.history.back();
     }
    function forward() {
      document.getElementById("iframeId").contentWindow.history.forward();
    }
    function hide() {
      var hidediv = document.getElementById('browser');
      if (hidediv.style.display === "none") {
        hidediv.style.display = "block";
      } else {
        hidediv.style.display = "none";
      }
    }
    function togglemenu() {
      var menu = document.getElementById("mySidebar")
      if (menu.style.visibility === "hidden") {
        menu.style.visibility = "visible";
      } else {
        menu.style.visibility = "hidden";
      }
    }
      function setIframe() {
        let encodedUrl = sessionStorage.getItem("encodedUrl");
        encodedUrl = "/static/ghost/" + encodedUrl;
        console.log(encodedUrl);
       document.querySelector("#iframeid").src = encodedUrl;
      };
      function setthemes() {
 if (localStorage.theme == "default") {
  themefile.href = "/static/index.css";
  if (localStorage.cloak == "off") {
   changeFavicon('../favicon.ico');
  };
 } else if (localStorage.theme == "noir") {
  themefile.href = "/static/css/themes/noir/noir.css";
 } else if (localStorage.theme == "void") {
  themefile.href = "/static/css/themes/void/void.css";
 } else if (localStorage.theme == "ip") {
  themefile.href ="/static/css/themes/ironprime/ironprime.css";
  logo.src = "/static/css/themes/fire/firethemelogo.png";
 } else if (localStorage.theme == "xg") {
  themefile.href ="/static/css/themes/xgames/xgames.css";
 } else if (localStorage.theme == "stealth") {
  themefile.href ="/static/css/themes/stealth/stealth.css";
 } else if (localStorage.theme == "fg") {
  themefile.href ="/static/css/themes/froggermans/froggermans.css";
 } else if (localStorage.theme == "ghost") {
  themefile.href ="/static/css/themes/ghost/ghost.css";
 } else if (localStorage.theme == "midnight") {
  themefile.href ="/static/css/themes/midnight/midnight.css";
 } else if (localStorage.theme == "fire") {
  themefile.href = "/static/css/themes/fire/fire.css";
  if (localStorage.cloak == "off") {
   changeFavicon('/static/css/themes/fire/firefavicon.ico');
  };
 } else if (localStorage.theme == "meteor") {
  themefile.href = "/static/css/themes/meteor/meteor.css";
 } else {
  themefile.href = "/static/index.css";
 }
};
function setcloaks() {
 if (localStorage.cloak == "drive") {
 changeFavicon('./images/favicon/drive.png');
 document.title = "My Drive - Google Drive";
 } else if (localStorage.cloak == "classroom") {
  changeFavicon('./images/favicon/classroom.png');
  document.title = "Home";
 } else if (localStorage.cloak == "google") {
  changeFavicon('./images/favicon/google.png');
  document.title = "Google";
 } else if (localStorage.cloak == "gmail") {
  changeFavicon('./images/favicon/gmail.png');
  document.title = "Inbox";
 };
};

var dropdown = document.getElementsByClassName("dropdown-btn");
var i;
for (i = 0; i < dropdown.length; i++) {
  dropdown[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var dropdownContent = this.nextElementSibling;
    if (dropdownContent.style.display === "block") {
      dropdownContent.style.display = "none";
    } else {
      dropdownContent.style.display = "block";
    }
  });
}

function initializeTitleUrlList() {
  if (!localStorage.getItem('titleUrlList')) {
  localStorage.setItem('titleUrlList', JSON.stringify([])); // Initialize an empty array if it doesn't exist
  }
  }
  
  // This function saves the title and URL from the iframe to the localStorage list
  function saveIframeTitleUrlToList() {
  const iframe = document.getElementById('iframeId');
  try {
  const iframeTitle = iframe.contentDocument.title;
  const iframeUrl = iframe.src;
  
  const titleUrlObject = { title: iframeTitle, url: iframeUrl };
  
  let titleUrlList = JSON.parse(localStorage.getItem('titleUrlList'));
  titleUrlList.push(titleUrlObject);
  localStorage.setItem('titleUrlList', JSON.stringify(titleUrlList));
  
  displayTitleUrlList(); // Update the display list after adding new title/url
  } catch (exception) {
  console.error('Cannot access iframe document:', exception);
  }
  }
  
  // This function updates the display of the title/url list under the div tag
  function displayTitleUrlList() {
  var listDiv = document.querySelector('#dropdown-container');
  let titleUrlList = JSON.parse(localStorage.getItem('titleUrlList')); // Get the list from localStorage
  
  // Construct a string of list items with the title as label and URL as a clickable link
  var listHtml = '<ul>';
  titleUrlList.forEach((item, index) => {
  listHtml += `<li>${item.title} - <a href="#" class="iframe-link" data-index="${index}">${item.url}</a></li>`;
  });
  listHtml += '</ul>';
  
  document.querySelector('#dropdown-container').appendChild(listHtml);
  
  // Add click event listeners to each link
  const links = document.querySelector('#dropdown-container').getElementsByClassName('iframe-link');
  for (let link of links) {
  link.addEventListener('click', function(event) {
  event.preventDefault();
  const index = this.dataset.index;
  const url = titleUrlList[index].url;
  document.getElementById('iframeId').src = url;
  });
  }
  }
  
  // Add click event listener to the button
  document.getElementById('bookmarkbtn').addEventListener('click', saveIframeTitleUrlToList);
  
  // Initialize the title/url list when the document is fully loaded
  document.addEventListener('DOMContentLoaded', function() {
  initializeTitleUrlList();
  displayTitleUrlList(); // Display the list on initial load
  });
setIframe();
    </script>
    <script src="/static/scripts/register-sw.js"></script>
    <script src="/static/scripts/search.js"></script>
    <script src="/static/scripts/index.js"></script>
  </body>
</html>